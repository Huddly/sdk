<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>huddly-sdk</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">huddly-sdk</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li >IpDetector</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#readme" role="tab" id="readme-tab" data-toggle="tab" data-link="readme">README</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/components/ipDetector.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Control class for configuring detector and subscribing to detection information.</p>

            </p>

            <p class="comment">
                <h3>Extends</h3>
            </p>
            <p class="comment">
                        <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>
            </p>

            <p class="comment">
                <h3>Implements</h3>
            </p>
            <p class="comment">
                            <code><a href="../classes/Detector.html" target="_self" >IDetector</a></code>
            </p>


            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#_getDetections" >_getDetections</a>
                            </li>
                            <li>
                                <a href="#_startDetections" >_startDetections</a>
                            </li>
                            <li>
                                <a href="#_stopDetections" >_stopDetections</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#destroy" >destroy</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#init" >init</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#updateOpts" >updateOpts</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(manager: IIpDeviceManager, options?: <a href="../classes/Detector.html" target="_self">DetectorOpts</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="53" class="link-to-prism">src/components/ipDetector.ts:53</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>manager</td>
                                                  
                                                        <td>
                                                                    <code>IIpDeviceManager</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>options</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Detector.html" target="_self" >DetectorOpts</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            Yes
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>


            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_getDetections"></a>
                    <span class="name">
                        <span ><b>_getDetections</b></span>
                        <a href="#_getDetections"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>_getDetections()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="160"
                            class="link-to-prism">src/components/ipDetector.ts:160</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Fetches detection information from camera.</p>
<p>The object type is described in the IP camera proto file.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;huddly.Detections&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise&lt;huddly.Detections&gt;} An object representing detection data retreived from the camera.
The object type is described in the IP camera proto file.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_startDetections"></a>
                    <span class="name">
                        <span ><b>_startDetections</b></span>
                        <a href="#_startDetections"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>_startDetections()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="182"
                            class="link-to-prism">src/components/ipDetector.ts:182</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Control command for starting detection feature.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when the detection feature is started.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_stopDetections"></a>
                    <span class="name">
                        <span ><b>_stopDetections</b></span>
                        <a href="#_stopDetections"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>_stopDetections()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="213"
                            class="link-to-prism">src/components/ipDetector.ts:213</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Control command for stopping detection feature.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when the detection feature is stopped.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="destroy"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>destroy</b></span>
                        <a href="#destroy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>destroy()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="261"
                            class="link-to-prism">src/components/ipDetector.ts:261</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Control command for tearing down the detector object.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when the teardown process is completed.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="init"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>init</b></span>
                        <a href="#init"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>init()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="68"
                            class="link-to-prism">src/components/ipDetector.ts:68</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Convenience function for setting detection and/or framing data event listeners.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<any>} Resolves when detector initialization is completed.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateOpts"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>updateOpts</b></span>
                        <a href="#updateOpts"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateOpts(options: <a href="../classes/Detector.html" target="_self">DetectorOpts</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="246"
                            class="link-to-prism">src/components/ipDetector.ts:246</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Helper function for updating the initial detector options specified when
instantiating the Detector class.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>options</td>
                                    <td>
                                                <code><a href="../classes/Detector.html" target="_self" >DetectorOpts</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The new detection options to be used.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<any>} Resolves when the new options have been applied and detector is initialized.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>

    <div class="tab-pane fade " id="c-readme">
        <p><h2 id="how-to-use-the-detector-interface">How to use the detector interface!</h2>
<p>In order to use the detector interface you need to make sure that the autozoom feature is enabled on the camera (see the <a href="https://github.com/Huddly/sdk-interfaces/blob/main/src/interfaces/ICnnControl.ts">ICnnControl</a>) interface for documentation on how to do it).</p>
<p>The detector interface allows you to subscribe to detection and/or framing data from the camera. Detector supports also getting detection data from Detector without having to stream the camera on the host machine.</p>
<p>It is still possible to get detections the old way, where you only get detection when streaming the camera on the host machine. We show you below how to do that!</p>
<div><pre class="line-numbers"><code class="language-javascript">/*
We suppose that the sdk has been initialized and autozoom feature is enabled
and running.
*/
...

/**
 * Get an instance of detector implementation from the
 * camera manager.
 */
const detector = cameraManager.getDetector();

// Always call `init`
await detector.init();

/*
Detector class implements EventEmitter and therefore implements
all the event emitter methods. Below we show how to listen
to detector events such as DETECTIONS and FRAMING.
*/

detector.on(&#39;DETECTIONS&#39;, (detectionList) =&gt; {
  // Process the array
});

detector.on(&#39;FRAMING&#39;, (framingInfo) =&gt; {
  // Process framing info
});


/**
 * When you are done, call `destroy` method to properly teardown
 * the detection instance.
 */
await detector.destroy();

...</code></pre></div><p><strong>!! NOTE !!</strong> When tearing down your application which is using the detector object, it is important that you call <code>destroy</code> method before closing the host application. Not doing so will leave the camera streaming internally after you have closed the application which might lead to confusion. The camera will stop generating detection data at some point when it detects that no host application is consuming its data. However, it is strongly recommended to properly teardown the detector instance from the host application.</p>
<h2 id="get-detections-only-when-streaming-dows">Get detections only when streaming (DOWS)</h2>
<p>If you would like to configure the detector so that you get detection events only and only when the user starts streaming the camera on the host machine, then the following code sinppet illustrates how to do just that:</p>
<div><pre class="line-numbers"><code class="language-javascript">...

/**
 * The `getDetector` method accepts options documented on
 * `IDetectorOpts` interface. One of the options allows you
 * to configure the detector to get detection only when
 * camera is streaming on the host machine. This option is
 * called `DOWS` short for Detections Only When Streaming.
 */
const detector = await cameraManager.getDetector({
  DOWS: true,
});

// Call init
await detector.init();

// Setup detection event listener
detector.on(&#39;DETECTIONS&#39;, (detectionList) =&gt; {
  // Your code here
});

// Teardown
await detector.destroy();
...</code></pre></div><h2 id="detector-events">Detector Events</h2>
<p>The detector class can emit the following events:</p>
<table class="table table-bordered compodoc-table">
<thead>
<tr>
<th>Event</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DETECTIONS</code></td>
<td align="left">Subscribe to this event to get detections from the camera. At the moment only the <code>People</code> class is supported from the detector.</td>
</tr>
<tr>
<td><code>FRAMING</code></td>
<td align="left">Subscribe to this event to get information about the framing. Framing data consists of a property called <code>bbox</code> which contains the coordinates (x, y, width and height) representing the framing data. The framer configuration on the camera will always make sure that the perfect framing of the people in the view is selected.</td>
</tr>
</tbody>
</table>
</p>
    </div>

    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { EventEmitter } from &#x27;events&#x27;;
import IDetector from &#x27;@huddly/sdk-interfaces/lib/interfaces/IDetector&#x27;;
import IIpDeviceManager from &#x27;@huddly/sdk-interfaces/lib/interfaces/IIpDeviceManager&#x27;;
import DetectorOpts, {
  DetectionConvertion,
} from &#x27;@huddly/sdk-interfaces/lib/interfaces/IDetectorOpts&#x27;;
import Logger from &#x27;@huddly/sdk-interfaces/lib/statics/Logger&#x27;;

import CameraEvents from &#x27;./../utilitis/events&#x27;;
import DetectionsConverter from &#x27;./../utilitis/detectionsConverter&#x27;;
import * as huddly from &#x27;@huddly/camera-proto/lib/api/huddly_pb&#x27;;
import throttle from &#x27;./../utilitis/throttle&#x27;;
import { Empty } from &#x27;google-protobuf/google/protobuf/empty_pb&#x27;;

const PREVIEW_IMAGE_SIZE &#x3D; { width: 832, height: 480 };

/**
 * Control class for configuring detector and subscribing to detection information.
 *
 * @export
 * @class IpDetector
 * @extends {EventEmitter}
 * @implements {IDetector}
 */
export default class IpDetector extends EventEmitter implements IDetector {
  /** @ignore */
  _deviceManager: IIpDeviceManager;
  /** @ignore */
  _detectionHandler: any;
  /** @ignore */
  _framingHandler: any;
  /** @ignore */
  _frame: any;
  /** @ignore */
  _options: DetectorOpts;
  /** @ignore */
  _intervalId: NodeJS.Timeout;
  /** @ignore */
  _defaultLabelWhiteList: Array&lt;String&gt; &#x3D; [&#x27;head&#x27;, &#x27;person&#x27;];
  /** @ignore */
  _subscriptionsSetup: boolean &#x3D; false;
  /** @ignore */
  _detectorInitialized: boolean &#x3D; false;
  /** @ignore */
  _previewStreamStarted: boolean &#x3D; false;
  /** @ignore */
  _usePeopleCount: boolean &#x3D; false;
  /** @ignore */
  _UPDATE_INTERVAL: number &#x3D; 500; // ms
  /** @ignore */
  _detectorWasStarted: boolean &#x3D; false;
  /** @ignore */
  _lastTimestamp: number &#x3D; undefined;

  constructor(manager: IIpDeviceManager, options?: DetectorOpts) {
    super();
    this._deviceManager &#x3D; manager;
    this._options &#x3D; options || {};
    this._validateOptions(this._options);
  }

  /**
   * Convenience function for setting detection and/or framing data event listeners.
   *
   * @return {*}  {Promise&lt;any&gt;} Resolves when detector initialization is completed.
   * @memberof IpDetector
   */
  async init(): Promise&lt;any&gt; {
    if (this._detectorInitialized) {
      Logger.warn(&#x27;Detector already initialized&#x27;, &#x27;L1 Detector&#x27;);
      return;
    }
    Logger.debug(&#x27;Initializing detector class&#x27;, &#x27;L1 Detector&#x27;);

    this._setupDetectionHandler();
    if (!this._options.DOWS) {
      await this._startDetections();
    }
    this._intervalId &#x3D; global.setInterval(
      () &#x3D;&gt; this._getDetections().then(this._detectionHandler),
      this._UPDATE_INTERVAL
    );
    this._detectorInitialized &#x3D; true;
    Logger.debug(&#x27;Detector class initialized and ready&#x27;, &#x27;L1 Detector&#x27;);
  }

  /**
   * @ignore
   *
   * @param {DetectorOpts} options
   * @memberof IpDetector
   */
  _validateOptions(options: DetectorOpts) {
    if (options.convertDetections &amp;&amp; options.convertDetections &#x3D;&#x3D;&#x3D; DetectionConvertion.FRAMING) {
      Logger.warn(
        &#x27;FRAMING opt is not fully supported on L1 yet. Convertion may not work as intended&#x27;,
        &#x27;L1 Detector&#x27;
      );
    }
    const currentSetOpts &#x3D; this._options;
    this._options &#x3D; {
      ...currentSetOpts,
      ...options,
    };
    this._options.DOWS &#x3D; (options &amp;&amp; options.DOWS) || false;
    this._options.includeRawDetections &#x3D; (options &amp;&amp; options.includeRawDetections) || false;
  }

  /**
   * @ignore
   *
   * @memberof IpDetector
   */
  _setupDetectionHandler() {
    // A negative timestamp means the IMX has not received any detections
    const detectionsAreInvalid &#x3D; ({ timestamp }) &#x3D;&gt; timestamp &lt; 0.0;
    // A timestamp of 0 is the default value, which will be the case for older L1-versions which do not set the timestamp
    const detectionsAreStale &#x3D; ({ timestamp }) &#x3D;&gt;
      timestamp !&#x3D;&#x3D; 0 &amp;&amp; timestamp &#x3D;&#x3D;&#x3D; this._lastTimestamp;

    const throttledInvalidWarning &#x3D; throttle(() &#x3D;&gt; {
      Logger.warn(
        &#x27;Invalid detections received, ensure detector is running / autozoom is on and stream is open.&#x27;,
        &#x27;L1 Detector&#x27;
      );
    }, 10000);

    this._detectionHandler &#x3D; (detectionBuffer) &#x3D;&gt; {
      const rawDetections &#x3D; detectionBuffer.toObject();
      if (detectionsAreInvalid(rawDetections)) {
        throttledInvalidWarning();
        return;
      }
      if (detectionsAreStale(rawDetections)) {
        return;
      }
      this._lastTimestamp &#x3D; rawDetections.timestamp;
      const convertedDetections &#x3D; this.convertDetections(
        rawDetections.detectionsList,
        this._options
      );
      this.emit(CameraEvents.DETECTIONS, convertedDetections);
      if (this._options.includeRawDetections) {
        // Workaround until this is fixed camera side
        if (rawDetections.detectionsList[0] &amp;&amp; rawDetections.detectionsList[0].label &#x3D;&#x3D;&#x3D; &#x27;NULL&#x27;) {
          rawDetections.detectionsList &#x3D; [];
        }
        this.emit(CameraEvents.RAW_DETECTIONS, rawDetections);
      }
    };
  }

  /**
   * Fetches detection information from camera.
   *
   * @return {*}  {Promise&lt;huddly.Detections&gt;} An object representing detection data retreived from the camera.
   * The object type is described in the IP camera proto file.
   * @memberof IpDetector
   */
  _getDetections(): Promise&lt;huddly.Detections&gt; {
    return new Promise((resolve, reject) &#x3D;&gt; {
      this._deviceManager.grpcClient.getDetections(
        new Empty(),
        (err, detections: huddly.Detections) &#x3D;&gt; {
          if (err !&#x3D; undefined) {
            Logger.error(&#x27;Unable to get detections&#x27;, err.stack || &#x27;&#x27;);
            reject(err.message || &#x27;Unknown error&#x27;);
            return;
          }
          resolve(detections);
        }
      );
    });
  }

  /**
   * Control command for starting detection feature.
   *
   * @return {*}  {Promise&lt;void&gt;} Resolves when the detection feature is started.
   * @memberof IpDetector
   */
  _startDetections(): Promise&lt;void&gt; {
    if (this._detectorWasStarted) {
      Logger.error(&#x27;Detector already started&#x27;, &#x27;&#x27;, &#x27;L1 Detector&#x27;);
      return;
    }
    return new Promise((resolve, reject) &#x3D;&gt; {
      const cnnFeature &#x3D; new huddly.CnnFeature();
      cnnFeature.setFeature(huddly.Feature.DETECTOR);
      cnnFeature.setMode(huddly.Mode.START);
      this._deviceManager.grpcClient.setCnnFeature(
        cnnFeature,
        (err, status: huddly.DeviceStatus) &#x3D;&gt; {
          if (err !&#x3D; undefined) {
            Logger.error(&#x27;Unable to start detections on L1&#x27;, err.stack || &#x27;&#x27;, &#x27;L1 Detector&#x27;);
            reject(err.message);
            return;
          }
          Logger.info(status.toString());
          this._detectorWasStarted &#x3D; true;
          resolve();
        }
      );
    });
  }

  /**
   * Control command for stopping detection feature.
   *
   * @return {*}  {Promise&lt;void&gt;} Resolves when the detection feature is stopped.
   * @memberof IpDetector
   */
  _stopDetections(): Promise&lt;void&gt; {
    if (!this._detectorWasStarted) {
      Logger.error(&#x27;Detector has not been started&#x27;, &#x27;&#x27;, &#x27;L1 Detector&#x27;);
      return;
    }
    return new Promise((resolve, reject) &#x3D;&gt; {
      const cnnFeature &#x3D; new huddly.CnnFeature();
      cnnFeature.setFeature(huddly.Feature.DETECTOR);
      cnnFeature.setMode(huddly.Mode.STOP);
      this._deviceManager.grpcClient.setCnnFeature(
        cnnFeature,
        (err, status: huddly.DeviceStatus) &#x3D;&gt; {
          if (err !&#x3D; undefined) {
            Logger.error(&#x27;Unable to stop detections on L1&#x27;, err.stack || &#x27;&#x27;, &#x27;L1 Detector&#x27;);
            reject(err.message);
            return;
          }
          Logger.info(status.toString());
          this._detectorWasStarted &#x3D; false;
          resolve();
        }
      );
    });
  }

  /**
   * Helper function for updating the initial detector options specified when
   * instantiating the Detector class.
   *
   * @param {DetectorOpts} options The new detection options to be used.
   * @return {*}  {Promise&lt;any&gt;} Resolves when the new options have been applied and detector is initialized.
   * @memberof IpDetector
   */
  async updateOpts(options: DetectorOpts): Promise&lt;any&gt; {
    this._validateOptions(options);
    if (this._intervalId) {
      clearInterval(this._intervalId);
    }
    this._detectorInitialized &#x3D; false;
    return this.init();
  }

  /**
   * Control command for tearing down the detector object.
   *
   * @return {*}  {Promise&lt;void&gt;} Resolves when the teardown process is completed.
   * @memberof IpDetector
   */
  async destroy(): Promise&lt;void&gt; {
    if (!this._detectorInitialized) {
      Logger.warn(&#x27;Detector already destroyed&#x27;, &#x27;L1 Detector&#x27;);
      return;
    }
    if (this._intervalId) {
      clearInterval(this._intervalId);
    }
    if (this._detectorWasStarted) {
      Logger.debug(&#x27;Sending stop-cnn Detector command&#x27;, &#x27;L1 Detector&#x27;);
      await this._stopDetections();
    }
    this._detectorInitialized &#x3D; false;
  }

  /**
   * Normalizes and filters detection objects so they are relative to image size.
   *
   * @ignore
   *
   * @param {Array&lt;any&gt;} detections Array of detections
   * @param {DetectorOpts} [opts] Returns an array of detections
   * @return {*}  {Array&lt;any&gt;}
   * @memberof IpDetector
   */
  convertDetections(detections: Array&lt;any&gt;, opts?: DetectorOpts): Array&lt;any&gt; {
    const converterOpts &#x3D; {
      frame: { ...this._frame },
      preview_image_size: { ...PREVIEW_IMAGE_SIZE },
      ...opts,
    };
    return new DetectionsConverter(detections, converterOpts).convert();
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'IpDetector.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
