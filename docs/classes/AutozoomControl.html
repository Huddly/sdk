<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>huddly-sdk</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">huddly-sdk</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li >AutozoomControl</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#readme" role="tab" id="readme-tab" data-toggle="tab" data-link="readme">README</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/components/autozoomControl.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Control class for configuring the Genius Framing feature of the camera.</p>

            </p>


            <p class="comment">
                <h3>Implements</h3>
            </p>
            <p class="comment">
                        <code>ICnnControl</code>
            </p>


            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#_setMode" >_setMode</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_validateOptions" >_validateOptions</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#disable" >disable</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#enable" >enable</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#init" >init</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#isEnabled" >isEnabled</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#isRunning" >isRunning</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#start" >start</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#stop" >stop</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#updateOpts" >updateOpts</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(manager: IDeviceManager, options?: <a href="../classes/AutozoomControl.html" target="_self">AutozoomControlOpts</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/components/autozoomControl.ts:20</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>manager</td>
                                                  
                                                        <td>
                                                                    <code>IDeviceManager</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>options</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/AutozoomControl.html" target="_self" >AutozoomControlOpts</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            Yes
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>


            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_setMode"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>_setMode</b></span>
                        <a href="#_setMode"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>_setMode(mode: AutozoomModes)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="293"
                            class="link-to-prism">src/components/autozoomControl.ts:293</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>mode</td>
                                    <td>
                                            <code>AutozoomModes</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_validateOptions"></a>
                    <span class="name">
                        <span class="modifier">Private</span>
                        <span ><b>_validateOptions</b></span>
                        <a href="#_validateOptions"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>_validateOptions(options: <a href="../classes/AutozoomControl.html" target="_self">AutozoomControlOpts</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="94"
                            class="link-to-prism">src/components/autozoomControl.ts:94</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>options</td>
                                    <td>
                                                <code><a href="../classes/AutozoomControl.html" target="_self" >AutozoomControlOpts</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="disable"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>disable</b></span>
                        <a href="#disable"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>disable(idleTimeMs: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="158"
                            class="link-to-prism">src/components/autozoomControl.ts:158</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Disables the cnn feature persistently. The disabled state is persistent on camera reboot/power cycle.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>idleTimeMs</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>2000</code>
                                    </td>

                                    <td>
                                        <p>Max time (in milliseconds) for the camera to respond to disable az control.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when feature is successfully disabled.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="enable"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>enable</b></span>
                        <a href="#enable"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>enable(idleTimeMs: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="114"
                            class="link-to-prism">src/components/autozoomControl.ts:114</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Enables the cnn feature persistently. The enable state is persistent on camera reboot/power cycle.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>idleTimeMs</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>2000</code>
                                    </td>

                                    <td>
                                        <p>Max time (in milliseconds) for the camera to respond to enable az control.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when feature is successfully enabled.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="init"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>init</b></span>
                        <a href="#init"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>init()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="37"
                            class="link-to-prism">src/components/autozoomControl.ts:37</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Convenience function for setting up the camera for starting/stopping cnn feature.
Should be called before any other methods.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<any>} Resolves when the initialisation is completed.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isEnabled"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>isEnabled</b></span>
                        <a href="#isEnabled"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isEnabled()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="201"
                            class="link-to-prism">src/components/autozoomControl.ts:201</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Checks if cnn feature is enabled on the camera. Returns true if yes, false otherwise.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;Boolean&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<Boolean>} Resolves to true if cnn features is enabled</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isRunning"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>isRunning</b></span>
                        <a href="#isRunning"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isRunning()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="262"
                            class="link-to-prism">src/components/autozoomControl.ts:262</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Checks if autozoom is running on the camera. Returns true if yes, false otherwise.</p>
<p>or not.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;Boolean&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<Boolean>} Resolves with information whether az control is running
or not.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="start"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>start</b></span>
                        <a href="#start"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>start()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="216"
                            class="link-to-prism">src/components/autozoomControl.ts:216</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Starts autozoom feature on the camera. User <code>Detector</code> class
for setting up detections and/or framing event listeners.</p>
<p>NOTE: For persistent enable of autozoom feature you
need to call the <code>enable</code> method.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when autozoom controler is started.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stop"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>stop</b></span>
                        <a href="#stop"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>stop()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="240"
                            class="link-to-prism">src/components/autozoomControl.ts:240</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Stops autozoom feature on the camera.</p>
<p>NOTE: For persistent disable of autozoom feature you
need to call the <code>disable</code> method.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<void>} Resolves when the autozoom control is stopped.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateOpts"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>updateOpts</b></span>
                        <a href="#updateOpts"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateOpts(newOpts: <a href="../classes/AutozoomControl.html" target="_self">AutozoomControlOpts</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="74"
                            class="link-to-prism">src/components/autozoomControl.ts:74</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Helper function for updating the initial detector options specified when
instantiating the Detector class.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>newOpts</td>
                                    <td>
                                                <code><a href="../classes/AutozoomControl.html" target="_self" >AutozoomControlOpts</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>{Promise<any>} Resolves when the new options have been applied and detector is initialized.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>

    <div class="tab-pane fade " id="c-readme">
        <p><h1 id="genius-framing-controller">Genius Framing Controller</h1>
<p>Below you can find an example on how to get started with Genius Framing (GF) on Huddly cameras that support the feature. Follow the steps below to enable or disable GF:</p>
<div><pre class="line-numbers"><code class="language-javascript">...
// We assume the sdk has been initialized and camera manager instance acquired
...

/**
 * Get an autozoom control instance from the initialized camera manager.
 * For custom autozoom, `getAutozoomControl` accepts some options which are
 * documented on the `IAutozoomControlOpts` interface.
 */
const autozoomCtrl = cameraManager.getAutozoomControl();

// Always call init before doing anything
await autozoomCtrl.init();

/* Enable autozoom cnn feature on the camera (persistent across camera booting) */
await autozoomCtrl.enable();

...
// Your code goes here
...

/* Disable autozoom cnn feature on the camera (persistent across camera booting) */
await autozoomCtrl.disable();</code></pre></div><p><strong>NOTE</strong>: For subscribing for detection and/or framing events you need to use the <code>Detector</code> class.</p>
</p>
    </div>

    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import AutozoomControlOpts from &#x27;@huddly/sdk-interfaces/lib/interfaces/IAutozoomControlOpts&#x27;;
import ICnnControl from &#x27;@huddly/sdk-interfaces/lib/interfaces/ICnnControl&#x27;;
import IDeviceManager from &#x27;@huddly/sdk-interfaces/lib/interfaces/IDeviceManager&#x27;;
import Logger from &#x27;@huddly/sdk-interfaces/lib/statics/Logger&#x27;;
import AutozoomModes from &#x27;@huddly/sdk-interfaces/lib/enums/AutozoomModes&#x27;;

import Api from &#x27;./api&#x27;;

/**
 * Control class for configuring the Genius Framing feature of the camera.
 *
 * @export
 * @class AutozoomControl
 * @implements {ICnnControl}
 */
export default class AutozoomControl implements ICnnControl {
  /** @ignore */
  _deviceManager: IDeviceManager;
  /** @ignore */
  _options: AutozoomControlOpts;

  constructor(manager: IDeviceManager, options?: AutozoomControlOpts) {
    this._deviceManager &#x3D; manager;
    this._options &#x3D; options || {
      shouldAutoFrame: true,
      mode: undefined,
    };
  }

  /**
   * Convenience function for setting up the camera for starting/stopping cnn feature.
   * Should be called before any other methods.
   *
   * @return {*}  {Promise&lt;any&gt;} Resolves when the initialisation is completed.
   * @memberof AutozoomControl
   */
  async init(): Promise&lt;any&gt; {
    Logger.info(&#x27;Fetching autozoom state...&#x27;, &#x27;Autozoom Control&#x27;);
    const azStatus &#x3D; await this._deviceManager.api.getAutozoomStatus();
    // Default to NORMAL for cameras without autozoom-mode support.
    const currentMode &#x3D; azStatus[&#x27;autozoom-mode&#x27;] || AutozoomModes.NORMAL;
    if (currentMode !&#x3D;&#x3D; this._options.mode) {
      Logger.info(&#x60;Setting autozoom-mode to: &#x27;${this._options.mode}&#x27;&#x60;, &#x27;Autozoom Control&#x27;);
      try {
        this._setMode(this._options.mode);
      } catch (e) {
        Logger.warn(&#x60;Failed in setting autozoom-mode: ${e}.&#x60;);
        this._options.mode &#x3D; undefined;
      }
    }
    if (this._options.shouldAutoFrame !&#x3D;&#x3D; undefined &amp;&amp; this._options.shouldAutoFrame !&#x3D;&#x3D; null) {
      Logger.debug(
        &#x60;Initializing autozoom with framing config option AUTO_PTZ: ${this._options.shouldAutoFrame}&#x60;,
        &#x27;Autozoom Control&#x27;
      );
      await this.uploadFramingConfig({
        AUTO_PTZ: this._options.shouldAutoFrame,
      });
      // Autozoom status command will after boot only respond
      // when the cnn is finished attempting to load the blob.
      // waiting to the status reply will assure the detector is ready.
      await this._deviceManager.api.getAutozoomStatus(8000);
    }
  }

  /**
   * Helper function for updating the initial detector options specified when
   * instantiating the Detector class.
   *
   * @param {AutozoomControlOpts} options The new az control options to be used.
   * @return {*}  {Promise&lt;any&gt;} Resolves when the new options have been applied and detector is initialized.
   * @memberof AutozoomControl
   */
  async updateOpts(newOpts: AutozoomControlOpts): Promise&lt;any&gt; {
    const prevOpts &#x3D; this._options;
    const nextOpts &#x3D; { ...prevOpts, ...newOpts };
    this._validateOptions(nextOpts);

    if (nextOpts.mode !&#x3D;&#x3D; prevOpts.mode) {
      try {
        await this._setMode(newOpts.mode);
      } catch (e) {
        Logger.error(&#x27;Failed in updating opts:&#x27;, e);
        return Promise.reject(e);
      }
    }
    this._options &#x3D; nextOpts;

    if (nextOpts.shouldAutoFrame !&#x3D;&#x3D; prevOpts.shouldAutoFrame) {
      await this.init();
    }
  }

  private _validateOptions(options: AutozoomControlOpts) {
    if (
      options.shouldAutoFrame &#x3D;&#x3D;&#x3D; false &amp;&amp;
      options.mode &amp;&amp;
      options.mode !&#x3D;&#x3D; AutozoomModes.NORMAL
    ) {
      const modeName &#x3D; options.mode;
      throw Error(
        &#x60;AutozoomMode &#x27;${modeName}&#x27; does not support option &#x27;shouldAutoFrame&#x27; set to ${options.shouldAutoFrame}!&#x60;
      );
    }
  }

  /**
   * Enables the cnn feature persistently. The enable state is persistent on camera reboot/power cycle.
   *
   * @param {number} [idleTimeMs&#x3D;2000] Max time (in milliseconds) for the camera to respond to enable az control.
   * @return {*}  {Promise&lt;void&gt;} Resolves when feature is successfully enabled.
   * @memberof AutozoomControl
   */
  async enable(idleTimeMs: number &#x3D; 2000): Promise&lt;void&gt; {
    Logger.debug(&#x27;Enabling autozoom persistently&#x27;, &#x27;Autozoom Control&#x27;);

    await this._deviceManager.api.sendAndReceive(
      Buffer.alloc(0),
      {
        send: &#x27;autozoom/enable&#x27;,
        receive: &#x27;autozoom/enable_reply&#x27;,
      },
      idleTimeMs
    );

    /**
     * &#x60;autozoom/enable&#x60; asynchronously sets the
     * &quot;autozoom_enabled&quot; property of the camera product
     * info. It is necessary to query the isEnabled more
     * than once to have a legitimate assertion.
     */
    const promise &#x3D; new Promise&lt;void&gt;(async (resolve, reject) &#x3D;&gt; {
      let retry &#x3D; 3;
      while (retry) {
        const isEnabled &#x3D; await this.isEnabled();
        if (isEnabled) {
          resolve();
          break;
        }
        retry -&#x3D; 1;
      }
      if (retry &#x3D;&#x3D;&#x3D; 0) {
        reject(new Error(&#x27;Autozoom not on after enable.&#x27;));
      }
    });

    await promise;
    Logger.debug(&#x27;Autozoom enabled persistently&#x27;, &#x27;Autozoom Control&#x27;);
  }

  /**
   * Disables the cnn feature persistently. The disabled state is persistent on camera reboot/power cycle.
   *
   * @param {number} [idleTimeMs&#x3D;2000] Max time (in milliseconds) for the camera to respond to disable az control.
   * @return {*}  {Promise&lt;void&gt;} Resolves when feature is successfully disabled.
   * @memberof AutozoomControl
   */
  async disable(idleTimeMs: number &#x3D; 2000): Promise&lt;void&gt; {
    Logger.debug(&#x27;Disabling autozoom persistently&#x27;, &#x27;Autozoom Control&#x27;);

    await this._deviceManager.api.sendAndReceive(
      Buffer.alloc(0),
      {
        send: &#x27;autozoom/disable&#x27;,
        receive: &#x27;autozoom/disable_reply&#x27;,
      },
      idleTimeMs
    );

    /**
     * &#x60;autozoom/disable&#x60; asynchronously sets the
     * &quot;autozoom_enabled&quot; property of the camera product
     * info. It is necessary to query the isEnabled more
     * than once to have a legitimate assertion.
     */
    const promise &#x3D; new Promise&lt;void&gt;(async (resolve, reject) &#x3D;&gt; {
      let retry &#x3D; 3;
      while (retry) {
        const isEnabled &#x3D; await this.isEnabled();
        if (!isEnabled) {
          resolve();
          break;
        }
        retry -&#x3D; 1;
      }
      if (retry &#x3D;&#x3D;&#x3D; 0) {
        reject(new Error(&#x27;Autozoom not off after disable.&#x27;));
      }
    });

    await promise;
    Logger.debug(&#x27;Autozoom disabled persistently&#x27;, &#x27;Autozoom Control&#x27;);
  }

  /**
   * Checks if cnn feature is enabled on the camera. Returns true if yes, false otherwise.
   *
   * @return {*}  {Promise&lt;Boolean&gt;} Resolves to true if cnn features is enabled
   * @memberof AutozoomControl
   */
  async isEnabled(): Promise&lt;Boolean&gt; {
    const prodInfo &#x3D; await this._deviceManager.api.getProductInfo();
    return prodInfo.autozoom_enabled;
  }

  /**
   * Starts autozoom feature on the camera. User &#x60;Detector&#x60; class
   * for setting up detections and/or framing event listeners.
   *
   * NOTE: For persistent enable of autozoom feature you
   * need to call the &#x60;enable&#x60; method.
   *
   * @return {*}  {Promise&lt;void&gt;} Resolves when autozoom controler is started.
   * @memberof AutozoomControl
   */
  async start(): Promise&lt;void&gt; {
    if (!(await this.isRunning())) {
      // Only start if not already started
      Logger.debug(&#x27;Starting Autozoom&#x27;, &#x27;Autozoom Control&#x27;);
      await this._deviceManager.api.sendAndReceive(
        Buffer.alloc(0),
        {
          send: &#x27;autozoom/start&#x27;,
          receive: &#x27;autozoom/start_reply&#x27;,
        },
        3000
      );
    }
  }

  /**
   * Stops autozoom feature on the camera.
   *
   * NOTE: For persistent disable of autozoom feature you
   * need to call the &#x60;disable&#x60; method.
   *
   * @return {*}  {Promise&lt;void&gt;} Resolves when the autozoom control is stopped.
   * @memberof AutozoomControl
   */
  async stop(): Promise&lt;void&gt; {
    if (await this.isRunning()) {
      // Only stop if az is running
      Logger.debug(&#x27;Stopping Autozoom&#x27;, &#x27;Autozoom Control&#x27;);
      await this._deviceManager.api.sendAndReceive(
        Buffer.alloc(0),
        {
          send: &#x27;autozoom/stop&#x27;,
          receive: &#x27;autozoom/stop_reply&#x27;,
        },
        3000
      );
    }
  }

  /**
   * Checks if autozoom is running on the camera. Returns true if yes, false otherwise.
   *
   * @return {*}  {Promise&lt;Boolean&gt;} Resolves with information whether az control is running
   * or not.
   * @memberof AutozoomControl
   */
  async isRunning(): Promise&lt;Boolean&gt; {
    const status &#x3D; await this._deviceManager.api.getAutozoomStatus();
    return status[&#x27;autozoom-active&#x27;];
  }

  /**
   * @ignore
   * Uploads the detector blob to the camera.
   *
   * @param {Buffer} blobBuffer The blob buffer to be uploaded to the camera.
   * @returns {Promise&lt;void&gt;} Void Promise.
   * @memberof AutozoomControl
   */
  async uploadBlob(blobBuffer: Buffer): Promise&lt;void&gt; {
    const status &#x3D; await this._deviceManager.api.getAutozoomStatus();
    if (!status[&#x27;network-configured&#x27;]) {
      Logger.debug(&#x27;Uploading cnn blob&#x27;, &#x27;Autozoom Control&#x27;);
      await this._deviceManager.api.sendAndReceive(
        blobBuffer,
        {
          send: &#x27;network-blob&#x27;,
          receive: &#x27;network-blob_reply&#x27;,
        },
        60000
      );
      Logger.debug(&#x27;Cnn blob has been uploaded. Unlocking the stream!&#x27;, &#x27;Autozoom Control&#x27;);
    } else {
      Logger.debug(&#x27;Cnn blob already configured on the camera&#x27;, &#x27;Autozoom Control&#x27;);
    }
  }

  async _setMode(mode: AutozoomModes) {
    const azStatus &#x3D; await this._deviceManager.api.getAutozoomStatus();
    // Default to NORMAL for cameras without autozoom-mode support.
    const currentMode &#x3D; azStatus[&#x27;autozoom-mode&#x27;] || AutozoomModes.NORMAL;
    if (currentMode &#x3D;&#x3D;&#x3D; mode) {
      Logger.info(&#x60;Camera already in autozoom-mode: &#x27;${mode}&#x27;&#x60;, &#x27;Autozoom Control&#x27;);
      return currentMode;
    }

    const modeKeys &#x3D; {
      normal: 0,
      plaza: 1,
      plaza_duplicate: 2,
    };
    Logger.debug(
      &#x60;Sending autozoom/set-mode request with param &#x27;{ mode: ${modeKeys[mode]} }&#x27;&#x60;,
      &#x27;Autozoom Control&#x27;
    );
    const response &#x3D; await this._deviceManager.api.sendAndReceiveMessagePack(
      { mode: modeKeys[mode] },
      {
        send: &#x27;autozoom/set-mode&#x27;,
        receive: &#x27;autozoom/set-mode_reply&#x27;,
      }
    );
    Logger.debug(&#x60;Received autozoom/set-mode response: ${JSON.stringify(response)}&#x60;);
    if (response[&#x27;autozoom-mode&#x27;] !&#x3D;&#x3D; mode) {
      throw new Error(
        &#x60;Could not set autozoomMode &#x27;${mode}&#x27;: Target replied with mode &#x27;${response[&#x27;autozoom-mode&#x27;]}&#x27;&#x60;
      );
    }
    return response[&#x27;autozoom-mode&#x27;];
  }

  /**
   * @ignore
   * Uploads the configuration file for the detector.
   *
   * @param {JSON} config JSON file representing the detector configuration.
   * @returns {Promise&lt;void&gt;} Void Promise.
   * @memberof AutozoomControl
   */
  async setDetectorConfig(config: JSON): Promise&lt;void&gt; {
    Logger.debug(&#x27;Sending detector config!&#x27;, &#x27;Autozoom Control&#x27;);
    await this._deviceManager.api.sendAndReceive(
      Api.encode(config),
      {
        send: &#x27;detector/config&#x27;,
        receive: &#x27;detector/config_reply&#x27;,
      },
      6000
    );
    Logger.debug(&#x27;Detector config sent!&#x27;, &#x27;Autozoom Control&#x27;);
  }

  /**
   * @ignore
   * Uploads the framing configuration file on the camera for using
   * new framing ruleset.
   *
   * @param {JSON} config JSON file representing the framing configuration.
   * @returns {Promise&lt;void&gt;} Void Promise.
   * @memberof AutozoomControl
   */
  async uploadFramingConfig(config: any): Promise&lt;void&gt; {
    Logger.debug(&#x27;Uploading new framing config&#x27;, &#x27;Autozoom Control&#x27;);
    await this._deviceManager.api.sendAndReceive(
      Api.encode(config),
      {
        send: &#x27;autozoom/framer-config&#x27;,
        receive: &#x27;autozoom/framer-config_reply&#x27;,
      },
      60000
    );
    Logger.debug(&#x27;New framing config uploaded on the camera.&#x27;, &#x27;Autozoom Control&#x27;);
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'AutozoomControl.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
