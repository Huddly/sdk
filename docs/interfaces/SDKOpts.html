<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>huddly-sdk</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">huddly-sdk</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>SDKOpts</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#readme" role="tab" id="readme-tab" data-toggle="tab" data-link="readme">README</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/index.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>The SDK initialization options.</p>

            </p>


        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#emitter">emitter</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#logger">logger</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="emitter"></a>
                                        <span class="name"><b>emitter</b><a href="#emitter"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>emitter:         <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Optional event emitter instance used to catch
SDK events!
See <code>utilitis/events</code> class for all possible events.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="logger"></a>
                                        <span class="name"><b>logger</b><a href="#logger"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>logger:         <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Logger instance used to log messages from the SDK.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>

    <div class="tab-pane fade " id="c-readme">
        <p><h2 id="sdk-usage">SDK Usage</h2>
<p>Please check the <a href="http://developer.huddly.com/index.html">Getting Started</a> guide to integrate the sdk with your awesome application. </p>
<h2 id="sdk-events">SDK Events</h2>
<p>When you create an instance of the SDK, you provide some options on the constructor:</p>
<div><pre class="line-numbers"><code class="language-javascript">const usbApi = new DeviceApiUSB();
const opts = {
  logger: new DefaultLogger(),
  //emitter: new EventEmitter(), &lt;- this is an optional parameter
};
const sdk = new SDK(usbApi, [usbApi], opts);</code></pre></div><p>If you do not provide the <code>emitter</code> option, the SDK instance itself will act as an Event Emitter. As a result you can use the sdk instance itself to listen for the supported events. The supported events are:</p>
<table class="table table-bordered compodoc-table">
<thead>
<tr>
<th>Event</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ATTACH</td>
<td align="left">The <code>ATTACH</code> event is fired by the SDK for each Huddly camera attached to your machine. This event will also be fired everytime you attach a new Huddly camera to the machine while the SDK instance is running. The <code>ATTACH</code> event gives you an instance of the <code>IDeviceManager</code> which can be used to communicate with the camera.</td>
</tr>
<tr>
<td>DETACH</td>
<td align="left">The <code>DETACH</code> event is fired by the SDK in case you a camera that has previously been discovered by the SDK is removed/detached from the host machine. The <code>DETACH</code> event gives you the <code>Serial Number</code> of the detached device.</td>
</tr>
</tbody>
</table>
<p>Examples of subscribing for <code>ATTACH</code> and <code>DETACH</code> events:</p>
<div><pre class="line-numbers"><code class="language-javascript">let connected = false;
let IQManager;
sdk.on(&#39;ATTACH&#39;, (cameraManager) =&gt; {
  // Proceed with communicating with the camera
  // For example...
  if (cameraManager.productName === &quot;Huddly IQ&quot;) {
    IQManager = cameraManager;
    connected = true;
  }
});

sdk.on(&#39;DETACH&#39;, (serial) =&gt; {
  if (cameraManager.serialNumber === serial) {
    // The camera you were using has been detached from the system.
    // Proceed with deinitializing the cameraManager instance
    camearManager = undefined;
    // For example...
    connnected = false;
  }
});</code></pre></div></p>
    </div>

    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { EventEmitter } from &#x27;events&#x27;;
import IHuddlyDeviceAPI from &#x27;./interfaces/iHuddlyDeviceAPI&#x27;;
import DefaultLogger from &#x27;./utilitis/logger&#x27;;
import DeviceFactory from &#x27;./components/device/factory&#x27;;
import CameraEvents from &#x27;./utilitis/events&#x27;;
import Locksmith from &#x27;./components/locksmith&#x27;;
import Api from &#x27;./components/api&#x27;;
import sourceMapSupport from &#x27;source-map-support&#x27;;
import ErrorCodes from &#x27;./error/errorCodes&#x27;;

sourceMapSupport.install();

class AttachError extends Error {
  code: Number;
  constructor(message: string, code: Number) {
    super(message);
    this.code &#x3D; code;
  }
}

/**
 * The SDK initialization options.
 *
 * @interface SDKOpts
 */
interface SDKOpts {
  /**
   * Logger instance used to log messages from the SDK.
   *
   * @type {*}
   * @memberof SDKOpts
   */
  logger?: any;
  /**
   * Optional event emitter instance used to catch
   * SDK events!
   * See &#x60;utilitis/events&#x60; class for all possible events.
   *
   * @type {EventEmitter}
   * @memberof SDKOpts
   */
  emitter?: EventEmitter;

  /**
   * @ignore
   *
   * @type {EventEmitter}
   * @memberof SDKOpts
   */
  apiDiscoveryEmitter?: EventEmitter;

  /**
   * @ignore
   *
   * @type {string}
   * @memberof SDKOpts
   */
  serial?: string;
}

/**
 * @export
 *
 * @class HuddlySdk
 * @implements {SDK}
 */
class HuddlySdk extends EventEmitter {
  /**
   * Event Emitter instance used to fire SDK events such as
   * ATTACH and DETACH camera events. For a full list of events
   * please see &#x60;events&#x60; class.
   *
   * @type {EventEmitter}
   * @memberof HuddlySdk
   */
  emitter: EventEmitter;

  /**
   * Logger instance used to log messages from the SDK.
   *
   * @type {DefaultLogger}
   * @memberof HuddlySdk
   */
  logger: DefaultLogger;

  /**
   * @ignore
   *
   * @type {EventEmitter}
   * @memberof HuddlySdk
   */
  deviceDiscovery: EventEmitter;
  /**
   * @ignore
   *
   * @type {IHuddlyDeviceAPI}
   * @memberof HuddlySdk
   */
  _mainDeviceApi: IHuddlyDeviceAPI;

  /**
   * @ignore
   *
   * @type {Array&lt;IHuddlyDeviceAPI&gt;}
   * @memberof HuddlySdk
   */
  _deviceApis: Array&lt;IHuddlyDeviceAPI&gt;;

  /**
   * @ignore
   *
   * @type {IHuddlyDeviceAPI}
   * @memberof HuddlySdk
   */
  _deviceDiscoveryApi: IHuddlyDeviceAPI;

  private locksmith: Locksmith;
  private targetSerial: string;

  /**
   * Creates an instance of HuddlySdk.
   * @param {IHuddlyDeviceAPI} deviceDiscoveryApi The Huddly device-api used for discovering the device.
   * @param {Array&lt;IHuddlyDeviceAPI&gt;} [deviceApis] Optional list of device-apis used for communicating with the device.
   * By default it uses the &#x60;deviceDiscoveryApi&#x60; parameter as the device-api used for communication.
   * @param {SDKOpts} [opts] Options used for initializing the sdk. See &#x60;SDKOpts&#x60; interface.
   * @memberof HuddlySdk
   */
  constructor(
    deviceDiscoveryApi: IHuddlyDeviceAPI,
    deviceApis?: Array&lt;IHuddlyDeviceAPI&gt;,
    opts?: SDKOpts
  ) {
    super();
    if (!deviceDiscoveryApi) {
      throw new Error(&#x27;A default device api should be provided to the sdk!&#x27;);
    }

    if (!deviceApis || deviceApis.length &#x3D;&#x3D;&#x3D; 0) {
      this.mainDeviceApi &#x3D; deviceDiscoveryApi;
      this._deviceApis &#x3D; new Array&lt;IHuddlyDeviceAPI&gt;();
      this._deviceApis.push(deviceDiscoveryApi);

    } else {
      this._mainDeviceApi &#x3D; deviceApis[0];
      this._deviceApis &#x3D; deviceApis;
    }

    this.locksmith &#x3D; new Locksmith();

    const options &#x3D; opts ? opts : {};

    this.deviceDiscovery &#x3D; options.apiDiscoveryEmitter || new EventEmitter();
    this.emitter &#x3D; options.emitter || this;
    this._deviceDiscoveryApi &#x3D; deviceDiscoveryApi;
    this.logger &#x3D; options.logger || new DefaultLogger(true);
    this.targetSerial &#x3D; options.serial;

    this.setupDeviceDiscoveryListeners();
    this._deviceDiscoveryApi.registerForHotplugEvents(this.deviceDiscovery);
  }

  /**
   * Sets up listeners for ATTACH and DETACH camera events on the
   * device discovery api.
   * Will emit instances of &#x60;IDeviceManager&#x60; when an ATTACH event occurs.
   * Will emit the device serial number when a DETACH event occurs.
   * @memberof HuddlySdk
   */
  setupDeviceDiscoveryListeners(): void {
    this.deviceDiscovery.on(CameraEvents.ATTACH, async d &#x3D;&gt; {
      if (d &amp;&amp; (!this.targetSerial || (this.targetSerial &#x3D;&#x3D;&#x3D; d.serialNumber)) ) {
        await this.locksmith.executeAsyncFunction(
          () &#x3D;&gt;
            new Promise(async resolve &#x3D;&gt; {
              try {
                const cameraManager &#x3D; await DeviceFactory.getDevice(
                  d.productId,
                  this.logger,
                  this.mainDeviceApi,
                  this.deviceApis,
                  d,
                  this.emitter
                );

                this.emitter.emit(CameraEvents.ATTACH, cameraManager);
                resolve();
              } catch (e) {
                this.logger.error(&#x60;Could not get device ${e}&#x60;, &#x27;SDK&#x27;);
                this.emitter.emit(CameraEvents.ERROR, new AttachError(&#x27;No transport supported&#x27;, ErrorCodes.NO_TRANSPORT));
              }
            })
        );
      }
    });

    this.deviceDiscovery.on(CameraEvents.DETACH, async (d) &#x3D;&gt; {
      if (d !&#x3D;&#x3D; undefined  &amp;&amp; (!this.targetSerial || (this.targetSerial &#x3D;&#x3D;&#x3D; d))) {
        await this.locksmith.executeAsyncFunction(() &#x3D;&gt; new Promise((resolve) &#x3D;&gt; {
          this.emitter.emit(CameraEvents.DETACH, d);
          resolve();
        }));
      }
    });
  }

  /**
   * Convenience function for setting the main device api
   * used for communicating with the camera.
   *
   * @memberof HuddlySdk
   */
  set mainDeviceApi(mainApi: IHuddlyDeviceAPI) {
    this._mainDeviceApi &#x3D; mainApi;
  }

  /**
   * Convenience function for getting the main device api
   * used for communicating with the camera.
   *
   * @type {IHuddlyDeviceAPI}
   * @memberof HuddlySdk
   */
  get mainDeviceApi(): IHuddlyDeviceAPI {
    return this._mainDeviceApi;
  }

  /**
   * Convenience function for setting the list of
   * device apis which the SDK uses to establish
   * communication channels with the camera.
   *
   * @memberof HuddlySdk
   */
  set deviceApis(deviceApis: Array&lt;IHuddlyDeviceAPI&gt;) {
    this._deviceApis &#x3D; deviceApis;
  }

  /**
   * Convenience function for getting the list of
   * device apis used to establish communication with
   * the camera.
   *
   * @type {Array&lt;IHuddlyDeviceAPI&gt;}
   * @memberof HuddlySdk
   */
  get deviceApis(): Array&lt;IHuddlyDeviceAPI&gt; {
    return this._deviceApis;
  }

  /**
   * Convenience function for setting the device api
   * instance used for camera discovery.
   *
   * @memberof HuddlySdk
   */
  set deviceDiscoveryApi(api: IHuddlyDeviceAPI) {
    this._deviceDiscoveryApi &#x3D; api;
    this.deviceDiscoveryApi.registerForHotplugEvents(this.deviceDiscovery);
  }

  /**
   * Convenience function for getting the device api
   * instance used for camera discovery.
   *
   * @type {IHuddlyDeviceAPI}
   * @memberof HuddlySdk
   */
  get deviceDiscoveryApi(): IHuddlyDeviceAPI {
    return this._deviceDiscoveryApi;
  }

  /**
   * Initializes the device discovery api which in turn will fire
   * ATTACH events for all cameras attached to the system.
   *
   * @returns {Promise&lt;any&gt;} Returns a promise which resolves for
   * successful initialization or rejects otherwise.
   * @memberof HuddlySdk
   */
  async init(): Promise&lt;any&gt; {
    await this.deviceDiscoveryApi.initialize();
  }
}
export { CameraEvents, Api };

export default HuddlySdk;
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'SDKOpts.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
